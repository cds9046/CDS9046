package com.example.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import com.example.mapper_oracle.CalMapper;
import com.example.mapper_oracle.CbMapper;
import com.example.mapper_oracle.CbrMapper;
import com.example.mapper_oracle.ClubMapper;
import com.example.mapper_oracle.CnMapper;
import com.example.mapper_oracle.CnrMapper;
import com.example.mapper_oracle.CuMapper;
import com.example.mapper_oracle.GroupMapper;
import com.example.mapper_oracle.GuMapper;
import com.example.mapper_oracle.MasterMapper;



@Service
public class Masterservice {
	@Autowired
	MasterMapper mapper;
	
	@Autowired
	CalMapper calmapper;
	
	@Autowired
	ClubMapper clubmapper;
	
	@Autowired
	CuMapper cumapper;
	
	@Autowired
	CnMapper cnmapper;
	
	@Autowired
	CnrMapper cnrmapper;
	
	@Autowired
	CbMapper cbmapper;
	
	@Autowired
	CbrMapper cbrmapper;
	
	@Autowired
	GroupMapper gmapper;
	
	@Autowired
	GuMapper gumapper;
	
	@Transactional
	public void mudelete(String id){
		calmapper.deleteCal(id);//
		
		int g_code = gumapper.searchgcode(id);
		//그룹이 없으면 gcode를 못받아와서 실패함
		int countgu = gumapper.countgu(g_code);
		if(countgu>1){
			System.out.println(countgu);
			gumapper.deleteMember(id);//
		}else if(countgu==1){
			System.out.println(countgu);
			gumapper.deleteMember(id);//
			gmapper.deleteGroup(g_code);
		}else{
			
		}
		
		//cu 에 다른 사람이 있으면 삭제 해줘야 함 c_code
		System.out.println(clubmapper.selectclub(id));
		if(id != pid ){			
			cbrmapper.deletecbr(id);
			cbmapper.deletecb(id);
			
			cnrmapper.deletecnr(id);
			
			cumapper.deletecu(id);
			
			mapper.mudelete(id);
		}else if(){
			cbrmapper.deletecbr(id);
			cbmapper.deletecb(id);
			
			cnrmapper.deletecnr(id);
			cnmapper.deletecn(id);
			
			cumapper.deletecu(id);
			clubmapper.deleteclub(id);
			
			mapper.mudelete(id);
		}
		
	}
	
	
	
	
}